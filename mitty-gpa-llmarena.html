# Updated GPA Calculator with Auto-Save

I've enhanced the code to **automatically save all data** whenever you make any changes. No need to click save - it happens instantly!

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archbishop Mitty GPA Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #8b0000 0%, #a52a2a 100%);
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        header h1 {
            color: #ffd700;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            color: #fff;
            font-size: 1.1em;
        }

        .save-status {
            background: #28a745;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            display: inline-block;
            margin-top: 10px;
        }

        .save-status.saving {
            background: #ffc107;
            color: #333;
        }

        .gpa-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .gpa-card {
            background: #fff;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }

        .gpa-card:hover {
            transform: translateY(-5px);
        }

        .gpa-card h3 {
            color: #8b0000;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .gpa-value {
            font-size: 3em;
            font-weight: bold;
            color: #1a1a2e;
        }

        .gpa-card small {
            color: #666;
            display: block;
            margin-top: 10px;
        }

        .year-section {
            background: #fff;
            border-radius: 15px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .year-header {
            background: linear-gradient(135deg, #8b0000 0%, #a52a2a 100%);
            color: #ffd700;
            padding: 15px 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
        }

        .year-header:hover {
            background: linear-gradient(135deg, #a52a2a 0%, #8b0000 100%);
        }

        .year-header h2 {
            font-size: 1.3em;
        }

        .year-gpa {
            display: flex;
            gap: 20px;
            font-size: 0.9em;
        }

        .year-content {
            padding: 20px;
            display: none;
        }

        .year-content.active {
            display: block;
        }

        .semester-section {
            margin-bottom: 25px;
        }

        .semester-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: #f5f5f5;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .semester-header h3 {
            color: #8b0000;
        }

        .semester-gpa {
            font-size: 0.9em;
            color: #666;
        }

        .course-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        .course-table th {
            background: #1a1a2e;
            color: #fff;
            padding: 12px;
            text-align: left;
            font-weight: 500;
        }

        .course-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #eee;
        }

        .course-table tr:hover {
            background: #f9f9f9;
        }

        .course-table input[type="text"] {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 0.95em;
            transition: border-color 0.3s;
        }

        .course-table input[type="text"]:focus {
            border-color: #8b0000;
            outline: none;
        }

        .course-table select {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 0.95em;
            background: #fff;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .course-table select:focus {
            border-color: #8b0000;
            outline: none;
        }

        .course-table input[type="number"] {
            width: 70px;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 0.95em;
            text-align: center;
        }

        .course-table input[type="number"]:focus {
            border-color: #8b0000;
            outline: none;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-add {
            background: #28a745;
            color: #fff;
        }

        .btn-add:hover {
            background: #218838;
        }

        .btn-remove {
            background: #dc3545;
            color: #fff;
            padding: 6px 12px;
            font-size: 0.85em;
        }

        .btn-remove:hover {
            background: #c82333;
        }

        .btn-clear {
            background: #6c757d;
            color: #fff;
        }

        .btn-clear:hover {
            background: #545b62;
        }

        .btn-print {
            background: #17a2b8;
            color: #fff;
        }

        .btn-print:hover {
            background: #138496;
        }

        .btn-export {
            background: #007bff;
            color: #fff;
        }

        .btn-export:hover {
            background: #0056b3;
        }

        .btn-import {
            background: #6f42c1;
            color: #fff;
        }

        .btn-import:hover {
            background: #5a32a3;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
            padding: 20px;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .toggle-icon {
            font-size: 1.5em;
            transition: transform 0.3s;
        }

        .toggle-icon.rotated {
            transform: rotate(180deg);
        }

        .points-display {
            font-weight: bold;
            color: #8b0000;
            min-width: 50px;
            text-align: center;
        }

        .info-box {
            background: #fff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .info-box h3 {
            color: #8b0000;
            margin-bottom: 15px;
        }

        .info-box ul {
            margin-left: 20px;
            color: #555;
        }

        .info-box li {
            margin-bottom: 8px;
        }

        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .legend-item {
            padding: 10px;
            background: #f5f5f5;
            border-radius: 8px;
        }

        .legend-item strong {
            color: #8b0000;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: #28a745;
            color: #fff;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        .last-saved {
            text-align: center;
            color: #fff;
            font-size: 0.85em;
            margin-top: 10px;
            opacity: 0.8;
        }

        .file-input {
            display: none;
        }

        @media print {
            body {
                background: #fff;
                padding: 10px;
            }

            .btn, .action-buttons, .info-box, .save-status, .last-saved {
                display: none !important;
            }

            .year-content {
                display: block !important;
            }

            .year-section {
                box-shadow: none;
                border: 1px solid #ddd;
            }

            .gpa-card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .course-table {
                font-size: 0.85em;
            }

            .course-table th, .course-table td {
                padding: 8px 6px;
            }

            .year-gpa {
                flex-direction: column;
                gap: 5px;
                font-size: 0.8em;
            }
        }

        .credits-cell {
            width: 80px;
        }

        .academic-yes {
            background-color: #d4edda;
        }

        .academic-no {
            background-color: #f8f9fa;
        }

        .data-info {
            background: #e7f3ff;
            border: 1px solid #b3d7ff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .data-info p {
            color: #004085;
            margin: 0;
        }

        .storage-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 5px;
            font-size: 0.9em;
        }

        .storage-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #28a745;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéì Archbishop Mitty High School</h1>
            <p>GPA Calculator - Unweighted, Weighted & Academic Weighted</p>
            <div class="save-status" id="save-status">‚úì Auto-Save Enabled</div>
            <div class="last-saved" id="last-saved"></div>
        </header>

        <div class="data-info">
            <p>üíæ <strong>Your data is automatically saved</strong> to your browser's local storage.</p>
            <div class="storage-indicator">
                <span class="storage-dot"></span>
                <span>Data persists even after closing the browser</span>
            </div>
        </div>

        <div class="gpa-summary">
            <div class="gpa-card">
                <h3>üìä Cumulative Unweighted GPA</h3>
                <div class="gpa-value" id="cumulative-unweighted">0.00</div>
                <small>Standard 4.0 Scale</small>
            </div>
            <div class="gpa-card">
                <h3>‚≠ê Cumulative Weighted GPA</h3>
                <div class="gpa-value" id="cumulative-weighted">0.00</div>
                <small>Honors/AP +1.0 Bonus</small>
            </div>
            <div class="gpa-card">
                <h3>üìö Academic Weighted GPA</h3>
                <div class="gpa-value" id="cumulative-academic">0.00</div>
                <small>Academic Courses Only (Weighted)</small>
            </div>
        </div>

        <div class="info-box">
            <h3>‚ÑπÔ∏è How GPA is Calculated</h3>
            <div class="legend">
                <div class="legend-item">
                    <strong>Unweighted:</strong> Standard 4.0 scale for all courses
                </div>
                <div class="legend-item">
                    <strong>Weighted:</strong> +1.0 for Honors/AP courses (max 5.0)
                </div>
                <div class="legend-item">
                    <strong>Academic Weighted:</strong> Only academic courses, with weighting
                </div>
                <div class="legend-item">
                    <strong>Credits:</strong> Typically 5 for full-year, 2.5 for semester
                </div>
            </div>
        </div>

        <div id="years-container"></div>

        <div class="action-buttons">
            <button class="btn btn-export" onclick="exportData()">üì§ Export Backup</button>
            <button class="btn btn-import" onclick="document.getElementById('import-file').click()">üì• Import Backup</button>
            <button class="btn btn-clear" onclick="clearAllData()">üóëÔ∏è Clear All Data</button>
            <button class="btn btn-print" onclick="window.print()">üñ®Ô∏è Print Report</button>
            <input type="file" id="import-file" class="file-input" accept=".json" onchange="importData(event)">
        </div>
    </div>

    <div class="notification" id="notification">Data saved successfully!</div>

    <script>
        // Grade point values
        const gradePoints = {
            'A+': 4.0, 'A': 4.0, 'A-': 3.7,
            'B+': 3.3, 'B': 3.0, 'B-': 2.7,
            'C+': 2.3, 'C': 2.0, 'C-': 1.7,
            'D+': 1.3, 'D': 1.0, 'D-': 0.7,
            'F': 0.0
        };

        const years = ['Freshman', 'Sophomore', 'Junior', 'Senior'];
        const semesters = ['Fall', 'Spring'];
        const STORAGE_KEY = 'mittyGPAData_v2';
        const SETTINGS_KEY = 'mittyGPASettings';

        // Initialize data structure
        let courseData = {};
        let saveTimeout = null;

        function initializeData() {
            years.forEach(year => {
                courseData[year] = {};
                semesters.forEach(semester => {
                    courseData[year][semester] = [];
                });
            });
        }

        // Auto-save function with debouncing
        function autoSave() {
            // Update status to saving
            const statusEl = document.getElementById('save-status');
            statusEl.textContent = '‚è≥ Saving...';
            statusEl.classList.add('saving');

            // Clear any existing timeout
            if (saveTimeout) {
                clearTimeout(saveTimeout);
            }

            // Debounce save to prevent too many writes
            saveTimeout = setTimeout(() => {
                try {
                    const dataToSave = {
                        courseData: courseData,
                        lastSaved: new Date().toISOString(),
                        version: 2
                    };
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
                    
                    // Update status
                    statusEl.textContent = '‚úì Saved';
                    statusEl.classList.remove('saving');
                    
                    // Update last saved time
                    updateLastSavedDisplay();
                    
                } catch (e) {
                    console.error('Error saving data:', e);
                    statusEl.textContent = '‚ö†Ô∏è Save Failed';
                    statusEl.classList.remove('saving');
                    showNotification('Error saving data. Storage may be full.');
                }
            }, 300); // 300ms debounce
        }

        function updateLastSavedDisplay() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    if (data.lastSaved) {
                        const date = new Date(data.lastSaved);
                        document.getElementById('last-saved').textContent = 
                            `Last saved: ${date.toLocaleDateString()} at ${date.toLocaleTimeString()}`;
                    }
                } catch (e) {
                    console.error('Error reading last saved time:', e);
                }
            }
        }

        function loadData() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    const data = JSON.parse(saved);
                    if (data.courseData) {
                        courseData = data.courseData;
                        
                        // Ensure all years and semesters exist
                        years.forEach(year => {
                            if (!courseData[year]) {
                                courseData[year] = {};
                            }
                            semesters.forEach(semester => {
                                if (!courseData[year][semester]) {
                                    courseData[year][semester] = [];
                                }
                            });
                        });
                        
                        updateLastSavedDisplay();
                        return true;
                    }
                }
            } catch (e) {
                console.error('Error loading data:', e);
            }
            return false;
        }

        function generateYearHTML(year, yearIndex) {
            return `
                <div class="year-section" id="year-${yearIndex}">
                    <div class="year-header" onclick="toggleYear(${yearIndex})">
                        <h2>üìÖ ${year} Year</h2>
                        <div style="display: flex; align-items: center; gap: 20px;">
                            <div class="year-gpa">
                                <span>UW: <strong id="year-uw-${yearIndex}">0.00</strong></span>
                                <span>W: <strong id="year-w-${yearIndex}">0.00</strong></span>
                                <span>AW: <strong id="year-aw-${yearIndex}">0.00</strong></span>
                            </div>
                            <span class="toggle-icon" id="toggle-${yearIndex}">‚ñº</span>
                        </div>
                    </div>
                    <div class="year-content" id="content-${yearIndex}">
                        ${semesters.map((semester, semIndex) => generateSemesterHTML(year, yearIndex, semester, semIndex)).join('')}
                    </div>
                </div>
            `;
        }

        function generateSemesterHTML(year, yearIndex, semester, semIndex) {
            const semId = `${yearIndex}-${semIndex}`;
            return `
                <div class="semester-section">
                    <div class="semester-header">
                        <h3>üìñ ${semester} Semester</h3>
                        <div class="semester-gpa">
                            UW: <strong id="sem-uw-${semId}">0.00</strong> | 
                            W: <strong id="sem-w-${semId}">0.00</strong> | 
                            AW: <strong id="sem-aw-${semId}">0.00</strong>
                        </div>
                    </div>
                    <table class="course-table">
                        <thead>
                            <tr>
                                <th style="width: 25%">Course Name</th>
                                <th style="width: 12%">Grade</th>
                                <th style="width: 15%">Course Type</th>
                                <th style="width: 12%">Academic?</th>
                                <th style="width: 10%" class="credits-cell">Credits</th>
                                <th style="width: 8%">UW Pts</th>
                                <th style="width: 8%">W Pts</th>
                                <th style="width: 10%">Action</th>
                            </tr>
                        </thead>
                        <tbody id="courses-${semId}">
                        </tbody>
                    </table>
                    <button class="btn btn-add" onclick="addCourse('${year}', '${semester}', '${semId}')">
                        ‚ûï Add Course
                    </button>
                </div>
            `;
        }

        function generateCourseRow(course, year, semester, semId, index) {
            const unweightedPts = course.grade ? gradePoints[course.grade] || 0 : 0;
            const weightBonus = (course.courseType === 'Honors' || course.courseType === 'AP') ? 1.0 : 0;
            const weightedPts = course.grade ? Math.min(unweightedPts + weightBonus, 5.0) : 0;
            const academicClass = course.isAcademic === 'Yes' ? 'academic-yes' : 'academic-no';

            return `
                <tr class="${academicClass}">
                    <td>
                        <input type="text" value="${escapeHtml(course.name || '')}" 
                            placeholder="Enter course name"
                            onchange="updateCourse('${year}', '${semester}', ${index}, 'name', this.value)"
                            oninput="updateCourse('${year}', '${semester}', ${index}, 'name', this.value)">
                    </td>
                    <td>
                        <select onchange="updateCourse('${year}', '${semester}', ${index}, 'grade', this.value)">
                            <option value="">--</option>
                            ${Object.keys(gradePoints).map(grade => 
                                `<option value="${grade}" ${course.grade === grade ? 'selected' : ''}>${grade}</option>`
                            ).join('')}
                        </select>
                    </td>
                    <td>
                        <select onchange="updateCourse('${year}', '${semester}', ${index}, 'courseType', this.value)">
                            <option value="Regular" ${course.courseType === 'Regular' ? 'selected' : ''}>Regular</option>
                            <option value="Honors" ${course.courseType === 'Honors' ? 'selected' : ''}>Honors</option>
                            <option value="AP" ${course.courseType === 'AP' ? 'selected' : ''}>AP</option>
                        </select>
                    </td>
                    <td>
                        <select onchange="updateCourse('${year}', '${semester}', ${index}, 'isAcademic', this.value)">
                            <option value="Yes" ${course.isAcademic === 'Yes' ? 'selected' : ''}>Yes</option>
                            <option value="No" ${course.isAcademic === 'No' ? 'selected' : ''}>No</option>
                        </select>
                    </td>
                    <td>
                        <input type="number" value="${course.credits || 5}" min="0" max="10" step="0.5"
                            onchange="updateCourse('${year}', '${semester}', ${index}, 'credits', parseFloat(this.value))">
                    </td>
                    <td class="points-display">${unweightedPts.toFixed(2)}</td>
                    <td class="points-display">${weightedPts.toFixed(2)}</td>
                    <td>
                        <button class="btn btn-remove" onclick="removeCourse('${year}', '${semester}', '${semId}', ${index})">‚úï</button>
                    </td>
                </tr>
            `;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function addCourse(year, semester, semId) {
            courseData[year][semester].push({
                name: '',
                grade: '',
                courseType: 'Regular',
                isAcademic: 'Yes',
                credits: 5
            });
            renderCourses(year, semester, semId);
            calculateAllGPAs();
            autoSave(); // Auto-save after adding course
        }

        function removeCourse(year, semester, semId, index) {
            courseData[year][semester].splice(index, 1);
            renderCourses(year, semester, semId);
            calculateAllGPAs();
            autoSave(); // Auto-save after removing course
        }

        function updateCourse(year, semester, index, field, value) {
            if (courseData[year] && courseData[year][semester] && courseData[year][semester][index]) {
                courseData[year][semester][index][field] = value;
                
                // Only re-render if academic status changed (for row styling)
                if (field === 'isAcademic' || field === 'grade' || field === 'courseType') {
                    const yearIndex = years.indexOf(year);
                    const semIndex = semesters.indexOf(semester);
                    const semId = `${yearIndex}-${semIndex}`;
                    renderCourses(year, semester, semId);
                }
                
                calculateAllGPAs();
                autoSave(); // Auto-save after any update
            }
        }

        function renderCourses(year, semester, semId) {
            const tbody = document.getElementById(`courses-${semId}`);
            if (tbody) {
                const courses = courseData[year][semester] || [];
                tbody.innerHTML = courses.map((course, index) => 
                    generateCourseRow(course, year, semester, semId, index)
                ).join('');
            }
        }

        function toggleYear(yearIndex) {
            const content = document.getElementById(`content-${yearIndex}`);
            const icon = document.getElementById(`toggle-${yearIndex}`);
            
            content.classList.toggle('active');
            icon.classList.toggle('rotated');
            
            // Save open/closed state
            saveYearState(yearIndex, content.classList.contains('active'));
        }

        function saveYearState(yearIndex, isOpen) {
            try {
                let settings = JSON.parse(localStorage.getItem(SETTINGS_KEY) || '{}');
                if (!settings.yearStates) settings.yearStates = {};
                settings.yearStates[yearIndex] = isOpen;
                localStorage.setItem(SETTINGS_KEY, JSON.stringify(settings));
            } catch (e) {
                console.error('Error saving year state:', e);
            }
        }

        function loadYearStates() {
            try {
                const settings = JSON.parse(localStorage.getItem(SETTINGS_KEY) || '{}');
                if (settings.yearStates) {
                    Object.keys(settings.yearStates).forEach(yearIndex => {
                        if (settings.yearStates[yearIndex]) {
                            const content = document.getElementById(`content-${yearIndex}`);
                            const icon = document.getElementById(`toggle-${yearIndex}`);
                            if (content && icon) {
                                content.classList.add('active');
                                icon.classList.add('rotated');
                            }
                        }
                    });
                    return true;
                }
            } catch (e) {
                console.error('Error loading year states:', e);
            }
            return false;
        }

        function calculateGPA(courses, weighted = false, academicOnly = false) {
            let totalPoints = 0;
            let totalCredits = 0;

            courses.forEach(course => {
                if (!course.grade) return;
                if (academicOnly && course.isAcademic !== 'Yes') return;

                const basePoints = gradePoints[course.grade] || 0;
                const credits = course.credits || 5;
                
                let points = basePoints;
                if (weighted && (course.courseType === 'Honors' || course.courseType === 'AP')) {
                    points = Math.min(basePoints + 1.0, 5.0);
                }

                totalPoints += points * credits;
                totalCredits += credits;
            });

            return totalCredits > 0 ? totalPoints / totalCredits : 0;
        }

        function calculateAllGPAs() {
            let allCourses = [];
            
            years.forEach((year, yearIndex) => {
                let yearCourses = [];
                
                semesters.forEach((semester, semIndex) => {
                    const courses = courseData[year][semester] || [];
                    const semId = `${yearIndex}-${semIndex}`;
                    
                    // Calculate semester GPAs
                    const semUW = calculateGPA(courses, false, false);
                    const semW = calculateGPA(courses, true, false);
                    const semAW = calculateGPA(courses, true, true);
                    
                    const semUWEl = document.getElementById(`sem-uw-${semId}`);
                    const semWEl = document.getElementById(`sem-w-${semId}`);
                    const semAWEl = document.getElementById(`sem-aw-${semId}`);
                    
                    if (semUWEl) semUWEl.textContent = semUW.toFixed(2);
                    if (semWEl) semWEl.textContent = semW.toFixed(2);
                    if (semAWEl) semAWEl.textContent = semAW.toFixed(2);
                    
                    yearCourses = yearCourses.concat(courses);
                });
                
                // Calculate year GPAs
                const yearUW = calculateGPA(yearCourses, false, false);
                const yearW = calculateGPA(yearCourses, true, false);
                const yearAW = calculateGPA(yearCourses, true, true);
                
                const yearUWEl = document.getElementById(`year-uw-${yearIndex}`);
                const yearWEl = document.getElementById(`year-w-${yearIndex}`);
                const yearAWEl = document.getElementById(`year-aw-${yearIndex}`);
                
                if (yearUWEl) yearUWEl.textContent = yearUW.toFixed(2);
                if (yearWEl) yearWEl.textContent = yearW.toFixed(2);
                if (yearAWEl) yearAWEl.textContent = yearAW.toFixed(2);
                
                allCourses = allCourses.concat(yearCourses);
            });
            
            // Calculate cumulative GPAs
            const cumUW = calculateGPA(allCourses, false, false);
            const cumW = calculateGPA(allCourses, true, false);
            const cumAW = calculateGPA(allCourses, true, true);
            
            document.getElementById('cumulative-unweighted').textContent = cumUW.toFixed(2);
            document.getElementById('cumulative-weighted').textContent = cumW.toFixed(2);
            document.getElementById('cumulative-academic').textContent = cumAW.toFixed(2);
        }

        function exportData() {
            const dataToExport = {
                courseData: courseData,
                exportDate: new Date().toISOString(),
                version: 2,
                school: 'Archbishop Mitty High School'
            };
            
            const blob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `MittyGPA_Backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Backup file downloaded!');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.courseData) {
                        if (confirm('This will replace all current data. Are you sure?')) {
                            courseData = data.courseData;
                            
                            // Ensure all years and semesters exist
                            years.forEach(year => {
                                if (!courseData[year]) {
                                    courseData[year] = {};
                                }
                                semesters.forEach(semester => {
                                    if (!courseData[year][semester]) {
                                        courseData[year][semester] = [];
                                    }
                                });
                            });
                            
                            renderAllCourses();
                            calculateAllGPAs();
                            autoSave();
                            showNotification('Data imported successfully!');
                        }
                    } else {
                        showNotification('Invalid backup file format.');
                    }
                } catch (err) {
                    console.error('Import error:', err);
                    showNotification('Error reading backup file.');
                }
            };
            reader.readAsText(file);
            
            // Reset file input
            event.target.value = '';
        }

        function clearAllData() {
            if (confirm('Are you sure you want to clear ALL data? This cannot be undone!')) {
                if (confirm('This is your last chance! Really delete everything?')) {
                    localStorage.removeItem(STORAGE_KEY);
                    localStorage.removeItem(SETTINGS_KEY);
                    initializeData();
                    renderAllCourses();
                    calculateAllGPAs();
                    document.getElementById('last-saved').textContent = '';
                    showNotification('All data cleared!');
                }
            }
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function renderAllCourses() {
            years.forEach((year, yearIndex) => {
                semesters.forEach((semester, semIndex) => {
                    const semId = `${yearIndex}-${semIndex}`;
                    renderCourses(year, semester, semId);
                });
            });
        }

        // Initialize the application
        function init() {
            // Initialize empty data structure first
            initializeData();
            
            // Generate year sections
            const container = document.getElementById('years-container');
            container.innerHTML = years.map((year, index) => generateYearHTML(year, index)).join('');
            
            // Try to load saved data
            loadData();
            
            // Render all courses
            renderAllCourses();
            
            // Calculate GPAs
            calculateAllGPAs();
            
            // Load year states or open freshman by default
            if (!loadYearStates()) {
                toggleYear(0);
            }
            
            // Update last saved display
            updateLastSavedDisplay();
        }

        // Run initialization
        init();

        // Also save before the page unloads (as backup)
        window.addEventListener('beforeunload', function() {
            // Force immediate save
            const dataToSave = {
                courseData: courseData,
                lastSaved: new Date().toISOString(),
                version: 2
            };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
        });
    </script>
</body>
</html>
```

## Key Auto-Save Features Added:

### üíæ **Automatic Saving**
- **Saves instantly** whenever you add, remove, or edit any course
- **Debounced** (300ms delay) to prevent excessive writes
- **Visual indicator** shows "Saving..." then "‚úì Saved"
- **Last saved timestamp** displayed in header

### üîÑ **Data Persistence**
- Data survives **page refresh**
- Data survives **closing the browser**
- Data survives **computer restart**
- **Year section open/closed states** are also remembered

### üì§ **Backup Options**
- **Export Backup** - Download a JSON file of all data
- **Import Backup** - Restore from a backup file
- Useful for transferring between computers or browsers

### üõ°Ô∏è **Safety Features**
- Saves on `beforeunload` (when closing tab/browser)
- Double-confirmation before clearing all data
- Versioned data format for future compatibility

## How It Works:
1. **Open the file** in your browser
2. **Start entering courses** - everything saves automatically
3. **Close and reopen anytime** - all data will be there
4. **Export backups** periodically for extra safety

The data is stored in your browser's **localStorage** - it stays on your specific browser on your specific computer. If you need to access it from another device, use the Export/Import backup feature!